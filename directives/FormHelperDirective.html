<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ngx-form-helper documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">ngx-form-helper documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content directive">
                   <div class="content-data">






<ol class="breadcrumb">
  <li>指令列表</li>
  <li>FormHelperDirective</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
        <li >
            <a href="#example" role="tab" id="example-tab" data-toggle="tab" data-link="example">Examples</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>文件</h3>
        </p>
        <p class="comment">
            <code>src/form-helper.directive.ts</code>
        </p>

            <p class="comment">
                <h3>描述</h3>
            </p>
            <p class="comment">
                <p>插件的控制中心</p>
<hr>
<p><strong><code>angular 表单存在的 BUG</code></strong></p>
<ul>
<li>bug：当使用 ngFor 迭代表单域，且 name 使用数组下标(如：name-{{i}})，此时若动态新增/删除表单域，会造成表单域混乱<br>
 fix：这种情况下请保证 name 唯一，且必须使用 trackBy 返回唯一标识，推荐使用 uuid 等工具(如：name-{{uuid}})</li>
</ul>
<p><example-url>/ngx-form-helper/demo/index.html</example-url></p>

            </p>

            <p class="comment">
                <h3>实现</h3>
            </p>
            <p class="comment">
                            <code><a href="https://angular.io/api/core/OnDestroy" target="_blank" >OnDestroy</a></code>
                            <code><a href="https://angular.io/api/core/AfterViewInit" target="_blank" >AfterViewInit</a></code>
            </p>


        <section>
            <h3>元数据</h3>
            <table class="table table-sm table-hover">
                <tbody>

                    <tr>
                        <td class="col-md-3">选择器</td>
                        <td class="col-md-9"><code>[formHelper]</code></td>
                    </tr>

                </tbody>
            </table>
        </section>

            <section>
    <h3 id="index">索引</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>属性列表</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#form">form</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>方法</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#repositionMessages">repositionMessages</a>
                            </li>
                            <li>
                                <a href="#reset">reset</a>
                            </li>
                            <li>
                                <a href="#submit">submit</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>输入属性</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#autoScroll">autoScroll</a>
                            </li>
                            <li>
                                <a href="#classNames">classNames</a>
                            </li>
                            <li>
                                <a href="#context">context</a>
                            </li>
                            <li>
                                <a href="#errorClassNames">errorClassNames</a>
                            </li>
                            <li>
                                <a href="#errorGroupClassNames">errorGroupClassNames</a>
                            </li>
                            <li>
                                <a href="#isolation">isolation</a>
                            </li>
                            <li>
                                <a href="#offsetTop">offsetTop</a>
                            </li>
                            <li>
                                <a href="#scrollProxy">scrollProxy</a>
                            </li>
                            <li>
                                <a href="#validateImmediate">validateImmediate</a>
                            </li>
                            <li>
                                <a href="#validateImmediateDescendants">validateImmediateDescendants</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>输出属性</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#validFail">validFail</a>
                            </li>
                            <li>
                                <a href="#validPass">validPass</a>
                            </li>
                        </ul>
                    </td>
                </tr>



                    <tr>
                        <td class="col-md-4">
                            <h6><b>存取器</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                    <a href="#controls">controls</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
        </tbody>
    </table>
</section>


            <section>
    <h3 id="inputs">输入属性</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="autoScroll"></a>
                        <b>autoScroll</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>true</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="171" class="link-to-prism">src/form-helper.directive.ts:171</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>是否开启自动滚动到第一个错误域功能</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="classNames"></a>
                        <b>classNames</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>&#x27;fh-theme&#x27;</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="231" class="link-to-prism">src/form-helper.directive.ts:231</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>主题样式</p>
<ul>
<li>指定的字符串会添加到 form 类名中。可设置多个值，空格符分割。插件已为默认值定义了一套主题样式</li>
</ul>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="context"></a>
                        <b>context</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>    <code>Window | ElementRef | HTMLElement | string</code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>window</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="151" class="link-to-prism">src/form-helper.directive.ts:151</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>表单所处上下文，通常为 window 或含有滚动条的 DOM 元素，影响滚动条正确滚动到第一条错误。
当类型为 string 时，支持 css选择器 和<code>点号表达式</code></p>
<hr>
<p><strong>点号表达式语法</strong></p>
<p>. =&gt; 当前节点，.. =&gt; 父节点，../../ etc</p>
<p><strong>点号表达式示例</strong></p>
<p>设置当前 form 元素为滚动对象</p>
<div><pre class="line-numbers"><code class="language-html">&lt;form formHelper context=&quot;.&quot;&gt;&lt;/form&gt;</code></pre></div><p>设置当前 form <code>父元素</code>为滚动对象，本例指 id=&quot;parent&quot; 的 div</p>
<div><pre class="line-numbers"><code class="language-html">&lt;div id=&quot;parent&quot;&gt;
   &lt;form formHelper context=&quot;..&quot;&gt;&lt;/form&gt;
&lt;/div&gt;</code></pre></div><p>设置当前 form <code>祖先元素</code>为滚动对象，本例指 id=&quot;ancestor&quot; 的 div</p>
<div><pre class="line-numbers"><code class="language-html">&lt;div id=&quot;ancestor&quot;&gt;
   &lt;div id=&quot;parent&quot;&gt;
     &lt;form formHelper context=&quot;../../&quot;&gt;&lt;/form&gt;
   &lt;/div&gt;
&lt;/div&gt;</code></pre></div></div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="errorClassNames"></a>
                        <b>errorClassNames</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>&#x27;fh-error&#x27;</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="252" class="link-to-prism">src/form-helper.directive.ts:252</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>验证失败时<code>表单域</code>自动添加的类名</p>
<hr>
<p><strong>附加样式</strong></p>
<p>表单域添加 <code>ignore</code> 类，将忽略给该元素设置验证失败样式</p>
<div><pre class="line-numbers"><code class="language-html">&lt;input type=&quot;text&quot; class=&quot;ignore&quot; name=&quot;name&quot; [(ngModel)]=&quot;xxx&quot; required&gt;</code></pre></div><p>表单域添加 <code>thin</code> 类，将设置元素左边框为细边框样式</p>
<div><pre class="line-numbers"><code class="language-html">&lt;input type=&quot;text&quot; class=&quot;thin&quot; name=&quot;name&quot; [(ngModel)]=&quot;xxx&quot; required&gt;</code></pre></div></div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="errorGroupClassNames"></a>
                        <b>errorGroupClassNames</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>&#x27;fh-group-error&#x27;</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="257" class="link-to-prism">src/form-helper.directive.ts:257</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>验证失败时<code>表单组</code>自动添加的类名。默认主题没有为 <code>fh-group-error</code> 设置样式，用户可在自己的样式文件中定义具体样式</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="isolation"></a>
                        <b>isolation</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>true</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="224" class="link-to-prism">src/form-helper.directive.ts:224</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>自身的验证状态是否隔离子控件的影响，只对<code>表单组</code>有效</p>
<p>  <code>表单组</code>当子控件有错误时，即使自身验证都通过(errors = null)，valid 也为 false。设置为 true 隔离子控件影响，
  只受自身验证器影响</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="offsetTop"></a>
                        <b>offsetTop</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>0</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="178" class="link-to-prism">src/form-helper.directive.ts:178</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>滚动定位使用，错误域距离浏览器顶部偏移量。默认滚动到第一个错误域与浏览器可视区域顶部重合处，
但大多数情况下页面是 有绝对定位(absolute)或固定定位(fixed)的头部的，此时会盖住滚动到此的错误域，
通过设置 offsetTop 解决此问题</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="scrollProxy"></a>
                        <b>scrollProxy</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="166" class="link-to-prism">src/form-helper.directive.ts:166</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>表单域/表单组的滚动代理。默认滚动到错误域本身，但当错误域本身处于不可见状态时，插件无法知道应该滚动到何处，
此时可使用另一个可见对象作为代理。 若没有设置滚动代理，且错误域本身不可见，会默认寻找其父域直到 ngForm，
使用第一个可见域作为代理</p>
<ul>
<li>全局配置，可被表单域/表单组自身相同配置覆盖，<a href="../classes/ErrorHandler.html#scrollProxy">参见</a></li>
</ul>
<hr>
<p><strong>语法</strong></p>
<p>^ =&gt; 父节点，~ =&gt; 前一个兄弟节点，+ =&gt; 后一个兄弟节点，可与数字任意组合，示例：^^^，^2，~3^4+2</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="validateImmediate"></a>
                        <b>validateImmediate</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>false</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="186" class="link-to-prism">src/form-helper.directive.ts:186</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>设置表单域/表单组是否<code>初始</code>就显示错误。默认只在控件 dirty 状态触发错误显示，所以表单初始不会显示错误，
当用户修改了表单或点提交按钮后才会显示错误</p>
<ul>
<li>全局配置，可被表单域/表单组自身相同配置覆盖，<a href="../classes/ErrorHandler.html#validateImmediate">参见</a></li>
</ul>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="validateImmediateDescendants"></a>
                        <b>validateImmediateDescendants</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>缺省值 : </i><code>true</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="216" class="link-to-prism">src/form-helper.directive.ts:216</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>设置<code>表单组</code>是否<code>初始</code>就显示其所有<code>子域</code>的错误。此配置仅在<code>全局(formHelper) validateImmediate = false</code> 和
<code>表单组自身 validateImmediate = true</code> 的条件下才有效，且只对<code>表单组</code>有效</p>
<ul>
<li>全局配置，可被表单域/表单组自身相同配置覆盖，<a href="../classes/ErrorHandler.html#validateImmediateDescendants">参见</a></li>
</ul>
<hr>
<p>如下示例，group 控件自身验证状态变化时，<code>会</code>同时触发所有子域的验证</p>
<div><pre class="line-numbers"><code class="language-html">&lt;form formHelper [validateImmediate]=&quot;false&quot;&gt;
   &lt;div ngModelGroup=&quot;group&quot; ehSimple [validateImmediate]=&quot;true&quot;&gt;
     ...
   &lt;/div&gt;
&lt;/form&gt;</code></pre></div><p>如下示例，group 控件自身验证状态变化时，<code>不会</code>同时触发所有子域的验证</p>
<div><pre class="line-numbers"><code class="language-html">&lt;form formHelper [validateImmediate]=&quot;false&quot;&gt;
   &lt;div ngModelGroup=&quot;group&quot; ehSimple [validateImmediate]=&quot;true&quot; [validateImmediateDescendants]=&quot;false&quot;&gt;
     ...
   &lt;/div&gt;
&lt;/form&gt;</code></pre></div></div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>
            <section>
    <h3 id="outputs">输出属性</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="validFail"></a>
                        <b>validFail</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://angular.io/api/core/EventEmitter" target="_blank" >EventEmitter</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="290" class="link-to-prism">src/form-helper.directive.ts:290</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>验证不通过事件</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="validPass"></a>
                        <b>validPass</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>类型 : </i>        <code><a href="https://angular.io/api/core/EventEmitter" target="_blank" >EventEmitter</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">被定义在 <a href="" data-line="285" class="link-to-prism">src/form-helper.directive.ts:285</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>验证通过事件。事件会传递 <a href="../miscellaneous/typealiases.html#SubmitComplete"><code>SubmitComplete</code></a> 方法</p>
<div><pre class="line-numbers"><code class="language-html">&lt;form formHelper (validPass)=&quot;save($event)&quot;&gt; ... &lt;/form&gt;</code></pre></div><div><pre class="line-numbers"><code class="language-js">\&#64;Component({ ... })
export class ExampleComponent {

<div><pre class="line-numbers"><code class="language-none"> constructor(private exampleService: ExampleService) {
 }

 save(complete: SubmitComplete) {
     this.exampleService.save().subscribe(res =&amp;gt; {
         // do something
         ...

         // 固定写法，插件收尾处理
         complete();
     });
 }</code></pre></div><p>}</code></pre></div></p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>


            <section>
    
    <h3 id="methods">
        方法
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="repositionMessages"></a>
                    <span class="name">
                        <b>
                            repositionMessages
                        </b>
                        <a href="#repositionMessages"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>repositionMessages(type?: <a href="../undefineds/RefType.html">RefType | AbstractControl</a>, delay?: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">被定义在 <a href="" data-line="444"
                            class="link-to-prism">src/form-helper.directive.ts:444</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>重定位错误消息。页面布局变化时，某些绝对定位错误消息位置可能需要重新定位。window:resize 事件已被插件处理，
会自动重定位错误消息，其他情况需要手动调用此方法</p>
<div><pre class="line-numbers"><code class="language-html">&lt;form formHelper #formHelperCtrl=&quot;formHelper&quot;&gt;
   &lt;div ngModelGroup=&quot;group&quot;&gt;
     ...
   &lt;/div&gt;
   &lt;button type=&quot;button&quot; (click)=&quot;formHelperCtrl.repositionMessages(&#39;group&#39;)&quot;&gt;重定位消息&lt;/div&gt;
&lt;/form&gt;</code></pre></div></div>

                    <div class="io-description">
                        <b>参数列表 :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>名称</td>
                                    <td>类型</td>
                                    <td>可选的</td>
                                    <td>描述</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>type</td>
                                    <td>
                                                <code><a href="../miscellaneous/typealiases.html#RefType" target="_self" >RefType | AbstractControl</a></code>
                                    </td>

                                    <td>
                                        是
                                    </td>


                                    <td>
                                        <p>需要重定位错误信息关联的表单控件指引，当控件为<code>表单组</code>时，其<code>子域</code>也会同时重定位。省略参数将重定位所有错误消息</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>delay</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        是
                                    </td>


                                    <td>
                                        <p>延时时间</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>返回 : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="reset"></a>
                    <span class="name">
                        <b>
                            reset
                        </b>
                        <a href="#reset"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>reset()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">被定义在 <a href="" data-line="423"
                            class="link-to-prism">src/form-helper.directive.ts:423</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>重置</p>
<hr>
<p>在重置按钮使用了<code>#reset</code>模板变量时可省略调用</p>
<div><pre class="line-numbers"><code class="language-html">&lt;form formHelper&gt;
   &lt;button type=&quot;button&quot; #reset&gt;重置&lt;/button&gt;
&lt;/form&gt;</code></pre></div><p>绑定事件方式</p>
<div><pre class="line-numbers"><code class="language-html">&lt;form formHelper #formHelperCtrl=&quot;formHelper&quot;&gt;
   &lt;button type=&quot;button&quot; (click)=&quot;formHelperCtrl.reset()&quot;&gt;重置&lt;/button&gt;
&lt;/form&gt;</code></pre></div></div>

                    <div class="io-description">
                        <b>返回 : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="submit"></a>
                    <span class="name">
                        <b>
                            submit
                        </b>
                        <a href="#submit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>submit(submitHandler?: <a href="../interfaces/SubmitHandler.html">SubmitHandler</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">被定义在 <a href="" data-line="353"
                            class="link-to-prism">src/form-helper.directive.ts:353</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>提交处理函数，不需要用户调用，通常在实现自定义的提交处理指令时需要</p>
</div>

                    <div class="io-description">
                        <b>参数列表 :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>名称</td>
                                    <td>类型</td>
                                    <td>可选的</td>
                                    <td>描述</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>submitHandler</td>
                                    <td>
                                                <code><a href="../interfaces/SubmitHandler.html" target="_self" >SubmitHandler</a></code>
                                    </td>

                                    <td>
                                        是
                                    </td>


                                    <td>
                                        <p>提交处理组件实例对象</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>返回 : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
        <h3 id="inputs">
            属性列表
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="form"></a>
                        <span class="name">
                            <b>
                            form</b>
                            <a href="#form"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>类型 : </i>    <code>HTMLFormElement</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">被定义在 <a href="" data-line="316" class="link-to-prism">src/form-helper.directive.ts:316</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>表单的 dom 元素</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
</section>

            <section>
    <h3 id="accessors">
        存取器
    </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="controls"></a>
                        <span class="name"><b>controls</b><a href="#controls"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>controls()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">被定义在 <a href="" data-line="487" class="link-to-prism">src/form-helper.directive.ts:487</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>控件树，屏蔽了<code>模板驱动</code>和<code>模型驱动</code>表单之间的差异</p>
</div>

                        </td>
                    </tr>

            </tbody>
        </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import {
    AfterViewInit, ContentChildren, Directive, ElementRef, EventEmitter, HostListener, Inject, InjectionToken, Input,
    NgZone, OnDestroy, Optional, Output, Provider, QueryList, Renderer2, SkipSelf
} from &#x27;@angular/core&#x27;;
import {
    AbstractControl, AbstractControlDirective, ControlContainer, FormArray, FormGroup, NgForm
} from &#x27;@angular/forms&#x27;;
import { forkJoin, interval, Observable, Subscription } from &#x27;rxjs&#x27;;
import { FormHelperConfig } from &#x27;./form-helper-config&#x27;;
import { arrayOfAbstractControls, arrayProviderFactory, getProxyElement, splitClassNames } from &#x27;./utils&#x27;;
import { first, skipWhile } from &#x27;rxjs/operators&#x27;;
import { SubmitHandler } from &#x27;./submit-handler/submit-handler&#x27;;
import { getOffset, getScrollTop, InputBoolean, InputNumber, isVisible, setScrollTop } from &#x27;@demacia/cmjs-lib&#x27;;
import { ErrorHandler, RefType } from &#x27;./error-handler/error-handler&#x27;;
import { CompleteConfig, SubmitComplete } from &#x27;./submit-complete&#x27;;

/**
 * @ignore
 */
const TWEEN &#x3D; require(&#x27;@tweenjs/tween.js&#x27;);

/**
 * @ignore
 */
export type ArrayOrGroupAbstractControls &#x3D; { [ key: string ]: AbstractControl } | AbstractControl[];

/**
 * @ignore
 */
export const FORM_HELPER_CONFIG &#x3D; new InjectionToken&lt;FormHelperConfig&gt;(&#x27;form_helper_config&#x27;);

/**
 * @ignore
 */
export const FORM_HELPER_CONFIG_ARRAY &#x3D; new InjectionToken&lt;FormHelperConfig[]&gt;(&#x27;form_helper_config_array&#x27;);

/**
 * [FormHelperDirective]{@link FormHelperDirective} 全局配置
 *
 * ~~~ js
 * \@NgModule({
 *     ...
 *     providers: [
 *         formHelperConfigProvider({
               offsetTop: 100
 *             ...
 *         })
 *     ]
 * })
 * export class CoreModule {
 * }
 * ~~~
 *
 * @param config 配置
 */
export function formHelperConfigProvider(config: FormHelperConfig): Provider[] {
    return [
        {
            provide: FORM_HELPER_CONFIG,
            useValue: config
        },
        {
            provide: FORM_HELPER_CONFIG_ARRAY,
            useFactory: arrayProviderFactory,
            deps: [ FORM_HELPER_CONFIG, [ new SkipSelf(), new Optional(), FORM_HELPER_CONFIG_ARRAY ] ]
        }
    ];
}

/**
 * 插件的控制中心
 *
 * ---
 *
 * **&#x60;angular 表单存在的 BUG&#x60;**
 *
 * - bug：当使用 ngFor 迭代表单域，且 name 使用数组下标(如：name-{{i}})，此时若动态新增/删除表单域，会造成表单域混乱&lt;br&gt;
 *   fix：这种情况下请保证 name 唯一，且必须使用 trackBy 返回唯一标识，推荐使用 uuid 等工具(如：name-{{uuid}})
 *
 * &lt;example-url&gt;/ngx-form-helper/demo/index.html&lt;/example-url&gt;
 */
@Directive({
    selector: &#x27;[formHelper]&#x27;,
    exportAs: &#x27;formHelper&#x27;
})
export class FormHelperDirective implements OnDestroy, AfterViewInit {

    /**
     * @ignore
     */
    @ContentChildren(ErrorHandler, { descendants: true }) errorHandlers: QueryList&lt;ErrorHandler&gt;;

    /**
     * @ignore
     */
    @ContentChildren(&#x27;reset&#x27;) set resets(resets: QueryList&lt;ElementRef&gt;) {
        resets.filter(reset &#x3D;&gt; this.resetEles.indexOf(reset.nativeElement) &lt; 0)
              .forEach(reset &#x3D;&gt; {
                  this.resetEles.push(reset.nativeElement);
                  this.subscription.add(this.renderer.listen(reset.nativeElement, &#x27;click&#x27;, () &#x3D;&gt; this.reset()));
              });
    }

    /**
     * @ignore
     */
    @ContentChildren(&#x27;submit&#x27;) set submits(submits: QueryList&lt;ElementRef&gt;) {
        submits.filter(submit &#x3D;&gt; this.submitEles.indexOf(submit.nativeElement) &lt; 0)
               .forEach(submit &#x3D;&gt; {
                   this.submitEles.push(submit.nativeElement);
                   this.subscription.add(this.renderer.listen(submit.nativeElement, &#x27;click&#x27;, () &#x3D;&gt; this.submit()));
               });
    }

    /**
     * 表单所处上下文，通常为 window 或含有滚动条的 DOM 元素，影响滚动条正确滚动到第一条错误。
     * 当类型为 string 时，支持 css选择器 和&#x60;点号表达式&#x60;
     *
     * ---
     *
     * **点号表达式语法**
     *
     * . &#x3D;&gt; 当前节点，.. &#x3D;&gt; 父节点，../../ etc
     *
     * **点号表达式示例**
     *
     * 设置当前 form 元素为滚动对象
     *
     * ~~~ html
     * &lt;form formHelper context&#x3D;&quot;.&quot;&gt;&lt;/form&gt;
     * ~~~
     *
     * 设置当前 form &#x60;父元素&#x60;为滚动对象，本例指 id&#x3D;&quot;parent&quot; 的 div
     *
     * ~~~ html
     * &lt;div id&#x3D;&quot;parent&quot;&gt;
     *   &lt;form formHelper context&#x3D;&quot;..&quot;&gt;&lt;/form&gt;
     * &lt;/div&gt;
     * ~~~
     *
     * 设置当前 form &#x60;祖先元素&#x60;为滚动对象，本例指 id&#x3D;&quot;ancestor&quot; 的 div
     *
     * ~~~ html
     * &lt;div id&#x3D;&quot;ancestor&quot;&gt;
     *   &lt;div id&#x3D;&quot;parent&quot;&gt;
     *     &lt;form formHelper context&#x3D;&quot;../../&quot;&gt;&lt;/form&gt;
     *   &lt;/div&gt;
     * &lt;/div&gt;
     * ~~~
     */
    @Input() context: Window | ElementRef | HTMLElement | string &#x3D; window;

    /**
     * 表单域/表单组的滚动代理。默认滚动到错误域本身，但当错误域本身处于不可见状态时，插件无法知道应该滚动到何处，
     * 此时可使用另一个可见对象作为代理。 若没有设置滚动代理，且错误域本身不可见，会默认寻找其父域直到 ngForm，
     * 使用第一个可见域作为代理
     *
     * - 全局配置，可被表单域/表单组自身相同配置覆盖，[参见]{@link ErrorHandler#scrollProxy}
     *
     * ---
     *
     * **语法**
     *
     * ^ &#x3D;&gt; 父节点，~ &#x3D;&gt; 前一个兄弟节点，+ &#x3D;&gt; 后一个兄弟节点，可与数字任意组合，示例：^^^，^2，~3^4+2
     */
    @Input() scrollProxy: string;

    /**
     * 是否开启自动滚动到第一个错误域功能
     */
    @Input() @InputBoolean() autoScroll: boolean &#x3D; true;

    /**
     * 滚动定位使用，错误域距离浏览器顶部偏移量。默认滚动到第一个错误域与浏览器可视区域顶部重合处，
     * 但大多数情况下页面是 有绝对定位(absolute)或固定定位(fixed)的头部的，此时会盖住滚动到此的错误域，
     * 通过设置 offsetTop 解决此问题
     */
    @Input() @InputNumber() offsetTop: number &#x3D; 0;

    /**
     * 设置表单域/表单组是否&#x60;初始&#x60;就显示错误。默认只在控件 dirty 状态触发错误显示，所以表单初始不会显示错误，
     * 当用户修改了表单或点提交按钮后才会显示错误
     *
     * - 全局配置，可被表单域/表单组自身相同配置覆盖，[参见]{@link ErrorHandler#validateImmediate}
     */
    @Input() @InputBoolean() validateImmediate: boolean &#x3D; false;

    /**
     * 设置&#x60;表单组&#x60;是否&#x60;初始&#x60;就显示其所有&#x60;子域&#x60;的错误。此配置仅在&#x60;全局(formHelper) validateImmediate &#x3D; false&#x60; 和
     * &#x60;表单组自身 validateImmediate &#x3D; true&#x60; 的条件下才有效，且只对&#x60;表单组&#x60;有效
     *
     * - 全局配置，可被表单域/表单组自身相同配置覆盖，[参见]{@link ErrorHandler#validateImmediateDescendants}
     *
     * ---
     *
     * 如下示例，group 控件自身验证状态变化时，&#x60;会&#x60;同时触发所有子域的验证
     *
     * ~~~ html
     * &lt;form formHelper [validateImmediate]&#x3D;&quot;false&quot;&gt;
     *   &lt;div ngModelGroup&#x3D;&quot;group&quot; ehSimple [validateImmediate]&#x3D;&quot;true&quot;&gt;
     *     ...
     *   &lt;/div&gt;
     * &lt;/form&gt;
     * ~~~
     *
     * 如下示例，group 控件自身验证状态变化时，&#x60;不会&#x60;同时触发所有子域的验证
     *
     * ~~~ html
     * &lt;form formHelper [validateImmediate]&#x3D;&quot;false&quot;&gt;
     *   &lt;div ngModelGroup&#x3D;&quot;group&quot; ehSimple [validateImmediate]&#x3D;&quot;true&quot; [validateImmediateDescendants]&#x3D;&quot;false&quot;&gt;
     *     ...
     *   &lt;/div&gt;
     * &lt;/form&gt;
     * ~~~
     */
    @Input() @InputBoolean() validateImmediateDescendants: boolean &#x3D; true;

    /**
     * 自身的验证状态是否隔离子控件的影响，只对&#x60;表单组&#x60;有效
     *
     *  &#x60;表单组&#x60;当子控件有错误时，即使自身验证都通过(errors &#x3D; null)，valid 也为 false。设置为 true 隔离子控件影响，
     *  只受自身验证器影响
     */
    @Input() @InputBoolean() isolation: boolean &#x3D; true;

    /**
     * 主题样式
     *
     * - 指定的字符串会添加到 form 类名中。可设置多个值，空格符分割。插件已为默认值定义了一套主题样式
     */
    @Input() classNames: string &#x3D; &#x27;fh-theme&#x27;;

    /**
     * 验证失败时&#x60;表单域&#x60;自动添加的类名
     *
     * ---
     *
     * **附加样式**
     *
     * 表单域添加 &#x60;ignore&#x60; 类，将忽略给该元素设置验证失败样式
     *
     * ~~~ html
     * &lt;input type&#x3D;&quot;text&quot; class&#x3D;&quot;ignore&quot; name&#x3D;&quot;name&quot; [(ngModel)]&#x3D;&quot;xxx&quot; required&gt;
     * ~~~
     *
     * 表单域添加 &#x60;thin&#x60; 类，将设置元素左边框为细边框样式
     *
     * ~~~ html
     * &lt;input type&#x3D;&quot;text&quot; class&#x3D;&quot;thin&quot; name&#x3D;&quot;name&quot; [(ngModel)]&#x3D;&quot;xxx&quot; required&gt;
     * ~~~
     */
    @Input() errorClassNames: string &#x3D; &#x27;fh-error&#x27;;

    /**
     * 验证失败时&#x60;表单组&#x60;自动添加的类名。默认主题没有为 &#x60;fh-group-error&#x60; 设置样式，用户可在自己的样式文件中定义具体样式
     */
    @Input() errorGroupClassNames: string &#x3D; &#x27;fh-group-error&#x27;;

    /**
     * 验证通过事件。事件会传递 [&#x60;SubmitComplete&#x60;]{@link SubmitComplete} 方法
     *
     * ~~~ html
     * &lt;form formHelper (validPass)&#x3D;&quot;save($event)&quot;&gt; ... &lt;/form&gt;
     * ~~~
     *
     * ~~~ js
     * \@Component({ ... })
     * export class ExampleComponent {
     *
     *     constructor(private exampleService: ExampleService) {
     *     }
     *
     *     save(complete: SubmitComplete) {
     *         this.exampleService.save().subscribe(res &#x3D;&gt; {
     *             // do something
     *             ...
     *
     *             // 固定写法，插件收尾处理
     *             complete();
     *         });
     *     }
     * }
     * ~~~
     */
    @Output() validPass &#x3D; new EventEmitter&lt;SubmitComplete&gt;();

    /**
     * 验证不通过事件
     */
    @Output() validFail &#x3D; new EventEmitter();

    /**
     * @ignore
     */
    @HostListener(&#x27;keydown&#x27;, [ &#x27;$event&#x27; ]) onKeydown(event: KeyboardEvent) {
        if ((event.keyCode || event.which) &#x3D;&#x3D;&#x3D; 13
            &amp;&amp; ((event.target || event.srcElement) as Element).nodeName.toUpperCase() !&#x3D;&#x3D; &#x27;TEXTAREA&#x27;) {
            event.preventDefault();
        }
    }

    /**
     * @ignore
     */
    @HostListener(&#x27;window:resize&#x27;) onResize() {
        this.errorHandlers.forEach(eh &#x3D;&gt; {
            if (eh.reposition) {
                eh.reposition();
            }
        });
    }

    /**
     * 表单的 dom 元素
     */
    form: HTMLFormElement;

    /**
     * @ignore
     */
    submitted: boolean;

    private subscription &#x3D; new Subscription();
    private resetEles: Element[] &#x3D; [];
    private submitEles: Element[] &#x3D; [];

    /**
     * @ignore
     */
    constructor(public ngForm: ControlContainer,
                private eleRef: ElementRef,
                private zone: NgZone,
                private renderer: Renderer2,
                @Optional() @Inject(FORM_HELPER_CONFIG_ARRAY) private overrideConfigs: FormHelperConfig[]) {
        Object.assign(this, ...(overrideConfigs || []));
        this.form &#x3D; eleRef.nativeElement;
    }

    ngAfterViewInit() {
        this.renderer.setAttribute(this.form, &#x27;novalidate&#x27;, &#x27;novalidate&#x27;);
        splitClassNames(this.classNames).forEach(cls &#x3D;&gt; this.renderer.addClass(this.form, cls));
    }

    ngOnDestroy() {
        this.subscription.unsubscribe();
    }

    /**
     * 提交处理函数，不需要用户调用，通常在实现自定义的提交处理指令时需要
     *
     * @param submitHandler 提交处理组件实例对象
     */
    submit(submitHandler?: SubmitHandler) {
        this.submitted &#x3D; true;

        if (this.ngForm.valid) {
            if (submitHandler) {
                submitHandler.start();
            }

            this.validPass.emit((config?: CompleteConfig) &#x3D;&gt; {
                let cfg &#x3D; Object.assign({ delay: 0 }, config);
                let handlerWrapper: Function;
                let handler &#x3D; () &#x3D;&gt; {
                    if (typeof cfg.callback &#x3D;&#x3D;&#x3D; &#x27;function&#x27;) {
                        cfg.callback();
                    }
                    if (cfg.reset) {
                        this.reset();
                    }
                };

                if (submitHandler) {
                    handlerWrapper &#x3D; () &#x3D;&gt; submitHandler.end(() &#x3D;&gt; handler());
                } else {
                    handlerWrapper &#x3D; () &#x3D;&gt; handler();
                }

                if (typeof cfg.delay &#x3D;&#x3D;&#x3D; &#x27;number&#x27; &amp;&amp; cfg.delay &gt;&#x3D; 0) {
                    setTimeout(() &#x3D;&gt; handlerWrapper(), cfg.delay);
                } else {
                    handlerWrapper();
                }
            });
        } else {
            this.validateControls();

            this.validFail.emit();

            if (this.autoScroll) {
                let pendings &#x3D; this.getPendingControls();

                if (pendings.length) {
                    forkJoin(pendings).subscribe(() &#x3D;&gt; this.scrollToTopError());
                } else {
                    this.scrollToTopError();
                }
            }
        }
    }

    /**
     * 重置
     *
     * ---
     *
     * 在重置按钮使用了&#x60;#reset&#x60;模板变量时可省略调用
     *
     * ~~~ html
     * &lt;form formHelper&gt;
     *   &lt;button type&#x3D;&quot;button&quot; #reset&gt;重置&lt;/button&gt;
     * &lt;/form&gt;
     * ~~~
     *
     * 绑定事件方式
     *
     * ~~~ html
     * &lt;form formHelper #formHelperCtrl&#x3D;&quot;formHelper&quot;&gt;
     *   &lt;button type&#x3D;&quot;button&quot; (click)&#x3D;&quot;formHelperCtrl.reset()&quot;&gt;重置&lt;/button&gt;
     * &lt;/form&gt;
     * ~~~
     */
    reset() {
        this.submitted &#x3D; false;
        this.resetControls();
    }

    /**
     * 重定位错误消息。页面布局变化时，某些绝对定位错误消息位置可能需要重新定位。window:resize 事件已被插件处理，
     * 会自动重定位错误消息，其他情况需要手动调用此方法
     *
     * ~~~ html
     * &lt;form formHelper #formHelperCtrl&#x3D;&quot;formHelper&quot;&gt;
     *   &lt;div ngModelGroup&#x3D;&quot;group&quot;&gt;
     *     ...
     *   &lt;/div&gt;
     *   &lt;button type&#x3D;&quot;button&quot; (click)&#x3D;&quot;formHelperCtrl.repositionMessages(&#x27;group&#x27;)&quot;&gt;重定位消息&lt;/div&gt;
     * &lt;/form&gt;
     * ~~~
     *
     * @param type 需要重定位错误信息关联的表单控件指引，当控件为&#x60;表单组&#x60;时，其&#x60;子域&#x60;也会同时重定位。省略参数将重定位所有错误消息
     * @param delay 延时时间
     */
    repositionMessages(type?: RefType | AbstractControl, delay?: number) {
        if (!type) {
            this.errorHandlers.forEach(errorHandler &#x3D;&gt; {
                if (errorHandler.reposition) {
                    if (isVisible(errorHandler.element)) {
                        errorHandler.reposition();
                    } else {
                        setTimeout(() &#x3D;&gt; errorHandler.reposition(), delay || 0);
                    }
                }
            });
        } else {
            let errorHandler: ErrorHandler;

            if (typeof type &#x3D;&#x3D;&#x3D; &#x27;string&#x27;) {
                errorHandler &#x3D; this.errorHandlers.find(eh &#x3D;&gt; eh.controlName &#x3D;&#x3D;&#x3D; type);
            } else if (type instanceof AbstractControlDirective) {
                errorHandler &#x3D; this.errorHandlers.find(eh &#x3D;&gt; eh.control &#x3D;&#x3D;&#x3D; type.control);
            } else if (type instanceof AbstractControl) {
                errorHandler &#x3D; this.errorHandlers.find(eh &#x3D;&gt; eh.control &#x3D;&#x3D;&#x3D; type);
            }

            if (errorHandler) {
                if (errorHandler.reposition) {
                    if (isVisible(errorHandler.element)) {
                        errorHandler.reposition();
                    } else {
                        setTimeout(() &#x3D;&gt; errorHandler.reposition(), delay || 0);
                    }
                }

                // 继续重定位后代错误消息
                if (errorHandler.control instanceof FormGroup || errorHandler.control instanceof FormArray) {
                    arrayOfAbstractControls(errorHandler.control.controls)
                        .forEach(item &#x3D;&gt; this.repositionMessages(item.control, delay));
                }
            }
        }
    }

    /**
     * 控件树，屏蔽了&#x60;模板驱动&#x60;和&#x60;模型驱动&#x60;表单之间的差异
     */
    get controls() {
        if (this.ngForm instanceof NgForm) {
            return this.ngForm.controls;
        } else {
            return (this.ngForm.control as FormGroup).controls;
        }
    }

    private static validateControl(control: AbstractControl) {
        // 设置control为dirty状态，使错误信息显示
        control.markAsDirty();

        // 触发control.statusChanges。默认会自动触发FormGroup的状态检测
        control.updateValueAndValidity();
    }

    private validateControls(controls: ArrayOrGroupAbstractControls &#x3D; this.controls) {
        arrayOfAbstractControls(controls).forEach(item &#x3D;&gt; {
            FormHelperDirective.validateControl(item.control);

            if (item.control instanceof FormGroup || item.control instanceof FormArray) {
                this.validateControls(item.control.controls);
            }
        });
    }

    private getPendingControls(controls: ArrayOrGroupAbstractControls &#x3D; this.controls) {
        let pendings: Observable&lt;any&gt;[] &#x3D; [];

        arrayOfAbstractControls(controls).forEach(item &#x3D;&gt; {
            if (item.control.enabled &amp;&amp; item.control.pending) {
                pendings.push(interval(100).pipe(skipWhile(() &#x3D;&gt; item.control.pending), first()));
            }
            if (item.control instanceof FormGroup || item.control instanceof FormArray) {
                pendings.push(...this.getPendingControls(item.control.controls));
            }
        });

        return pendings;
    }

    private scrollToTopError() {
        let context &#x3D; this.findContext() || window;

        if (!context) {
            return;
        }

        let minOffsetTop &#x3D; this.calcMinOffsetTop();

        if (minOffsetTop &#x3D;&#x3D;&#x3D; Number.MAX_SAFE_INTEGER) {
            minOffsetTop &#x3D; getOffset(this.form).top;
        }

        minOffsetTop -&#x3D; this.offsetTop;

        // 非window滚动窗体中表单域实际offsetTop需要减去滚动体offsetTop，加上滚动体当前scrollTop
        if (context !&#x3D;&#x3D; window &amp;&amp; context instanceof HTMLElement &amp;&amp; context.nodeName.toUpperCase() !&#x3D;&#x3D; &#x27;HTML&#x27;) {
            minOffsetTop -&#x3D; getOffset(context).top;
            minOffsetTop +&#x3D; context.scrollTop;
        }

        let curScrollTop &#x3D; getScrollTop(context);

        // 如果待滚到位置在可视窗口内，则忽略
        if (minOffsetTop &gt;&#x3D; curScrollTop) {
            return;
        }

        let animationRequest: number;
        let currentTween &#x3D; new TWEEN.Tween({ y: curScrollTop })
            .to({ y: minOffsetTop }, 500)
            .easing(TWEEN.Easing.Quadratic.Out)
            .onUpdate((data: any) &#x3D;&gt; {
                if (!isNaN(data.y)) {
                    setScrollTop(context, data.y);
                }
            })
            .onComplete(() &#x3D;&gt; cancelAnimationFrame(animationRequest))
            .start();

        const animate &#x3D; (time?: any) &#x3D;&gt; {
            currentTween.update(time);
            if (currentTween._object.y !&#x3D;&#x3D; minOffsetTop) {
                this.zone.runOutsideAngular(() &#x3D;&gt; animationRequest &#x3D; requestAnimationFrame(animate));
            }
        };

        animate();
    }

    private findContext() {
        if (typeof this.context &#x3D;&#x3D;&#x3D; &#x27;string&#x27;) {
            // 处理点号表达式
            if (/^(\.\/?|\.\.(\/\.\.)*\/?)$/.test(this.context)) {
                if (/^\.\/?$/.test(this.context)) {
                    return this.form;
                } else {
                    let num &#x3D; this.context.split(&#x27;/&#x27;).filter(v &#x3D;&gt; v).length,
                        field: Element &#x3D; this.form,
                        n &#x3D; 0;

                    while (n++ &lt; num) {
                        field &#x3D; field.parentElement;

                        if (!field) {
                            return window;
                        }
                    }

                    return field;
                }
            } else {
                return document.querySelector(this.context);
            }
        } else if (this.context instanceof ElementRef) {
            return this.context.nativeElement;
        } else {
            return this.context;
        }
    }

    private calcMinOffsetTop(controls: ArrayOrGroupAbstractControls &#x3D; this.controls) {
        let minOffsetTop &#x3D; Number.MAX_SAFE_INTEGER;
        let offsetTop: number;
        let closestVisibleElement: HTMLElement;

        for (let item of arrayOfAbstractControls(controls)) {
            if (item.control.enabled &amp;&amp; item.control.invalid) {
                // 跳过ngModelGroup，由其子控件计算合适的元素
                if (item.control instanceof FormGroup || item.control instanceof FormArray) {
                    offsetTop &#x3D; this.calcMinOffsetTop(item.control.controls);

                    if (offsetTop !&#x3D;&#x3D; Number.MAX_SAFE_INTEGER) {
                        minOffsetTop &#x3D; Math.min(offsetTop, minOffsetTop);
                        continue;
                    }

                    // offset &#x3D;&#x3D; Number.MAX_SAFE_INTEGER
                    // 此场景为ngModelGroup -&gt; invalid，ngModelGroup.controls -&gt; valid
                    // 原因：ngModelGroup约束条件失败，但没有子组件或所有子控件不具备约束条件
                    // 结果：其所有子组件状态都是valid
                    // fix：这种场景下ngModelGroup不跳过，加入下面的计算
                }

                closestVisibleElement &#x3D; this.findClosestVisibleItem(item.control) as HTMLElement;
                if (closestVisibleElement) {
                    minOffsetTop &#x3D; Math.min(getOffset(closestVisibleElement).top, minOffsetTop);
                }
            }
        }

        return minOffsetTop;
    }

    private findClosestVisibleItem(control: AbstractControl): Element | null {
        let errorHandler &#x3D; this.errorHandlers.find(eh &#x3D;&gt; eh.control &#x3D;&#x3D;&#x3D; control);

        // 没有使用ErrorHandler指令标记的控件，将失去插件相关功能
        if (!errorHandler || !errorHandler.controlElement) {
            return null;
        }

        // 优先使用滚动代理
        let proxyEle &#x3D; getProxyElement(errorHandler.controlElement, errorHandler.scrollProxy);
        if (proxyEle &amp;&amp; isVisible(proxyEle)) {
            return proxyEle;
        }

        // 表单域本身
        if (isVisible(errorHandler.controlElement)) {
            return errorHandler.controlElement;
        }

        // 最近可见父组件
        if (control.parent &amp;&amp; control.parent !&#x3D;&#x3D; this.ngForm.control) {
            return this.findClosestVisibleItem(control.parent);
        }

        // 没有找到符合元素，此表单域会被滚动定位忽略
        return null;
    }

    private resetControls() {
        // 表单域值重置
        // PS: 设置了standalone的表单域无法重置。使用form.reset()只能重置view，不能重置对应model
        this.ngForm.reset();

        // 表单域状态还原
        this.markAllControlsPristine();

        // 关闭错误提示
        if (this.errorHandlers) {
            this.errorHandlers.forEach(eh &#x3D;&gt; eh.whenValid &amp;&amp; eh.whenValid());
        }
    }

    private markAllControlsPristine(controls: ArrayOrGroupAbstractControls &#x3D; this.controls) {
        arrayOfAbstractControls(controls).forEach(item &#x3D;&gt; {
            item.control.markAsPristine({ onlySelf: true });

            if (item.control instanceof FormGroup || item.control instanceof FormArray) {
                this.markAllControlsPristine(item.control.controls);
            }
        });
    }

}</code></pre>
    </div>

    <div class="tab-pane fade " id="c-example">
            <iframe class="exampleContainer" src="/ngx-form-helper/demo/index.html">
                <p>no-iframes</p>
            </iframe>
    </div>
</div>








                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">无匹配的结果 "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'directive';
            var COMPODOC_CURRENT_PAGE_URL = 'FormHelperDirective.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
